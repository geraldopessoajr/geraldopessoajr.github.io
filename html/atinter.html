<!DOCTYPE html>
<meta charset="utf-8">
<html lang="pt-br">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../../../../favicon.ico">

    <title>Temporal analysis</title>
    <script src="../js/d3.v3.min.js"></script>
    <script src="../js/d3.tip.v0.6.3.js"></script>
    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    

    <!-- Custom styles for this template -->
    <link href="../css/disttempo.css" rel="stylesheet">
  </head>

  <body>
   
    <nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top">
      <a class="navbar-brand" href="../index.html">O Trabalho</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarsExampleDefault">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="https://example.com" id="dropdown01" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Colaborações por Grande Áreas</a>
            <div class="dropdown-menu" aria-labelledby="dropdown01">		
              <a class="dropdown-item" href="./coautoria.html">por Grande Áreas</a>
              <a class="dropdown-item" href="./coautoriatodos.html">Grande Áreas</a>
              <a class="dropdown-item" href="./coautoriatodos100.html">Grande Áreas 100%</a>
            </div>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="https://example.com" id="dropdown01" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Colaborações por Região Geográfica</a>
            <div class="dropdown-menu" aria-labelledby="dropdown01">
              <a class="dropdown-item" href="./mapa.html">Estatísticas por Região</a>
              <a class="dropdown-item" href="./region.html">por Região</a>
              <a class="dropdown-item" href="./regiontodos.html">Região</a>
              <a class="dropdown-item" href="./regiontodos100.html">Região 100%</a>
              <a class="dropdown-item" href="./regiongreatarea.html">Grande Áreas</a>
              <a class="dropdown-item" href="./regionpergreatarea.html">Grande Áreas (por Região)</a>
            </div>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="https://example.com" id="dropdown01" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Colaborações por Idade Acadêmica do Pesquisador</a>
            <div class="dropdown-menu" aria-labelledby="dropdown01">    
              <a class="dropdown-item" href="./atinter.html">por Ano</a>
              <a class="dropdown-item" href="./inter.html">por Grande Áreas</a>
              <a class="dropdown-item" href="./intertodos.html">Grande Áreas</a>
              <a class="dropdown-item" href="./intertodos100.html">Grande Áreas 100%</a>
            </div>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="https://example.com" id="dropdown01" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Análise Temporal</a>
            <div class="dropdown-menu" aria-labelledby="dropdown01">
              <a class="dropdown-item" href="./disttempo.html">por Grande Áreas</a>
              <a class="dropdown-item" href="./disttempotodos1.html">Grande Áreas [< 2k]</a>
              <a class="dropdown-item" href="./disttempotodos2.html">Grande Áreas [2k, 4k]</a>
              <a class="dropdown-item" href="./disttempotodos3.html">Grande Áreas [> 4k]</a>
            </div>
          </li>
        </ul>
      </div>
    </nav>

    <main role="main" class="container">

      <div class="starter-template">
        <h1>Temporal analysis</h1>
        <!-- <p class="lead">Use this document as a way to quickly start any new project.<br> All you get is this text and a mostly barebones HTML document.</p> -->
      </div>

    </main><!-- /.container -->

  <div id="corpo">
          <div style="display: flex;justify-content: flex-start;">
<!--Select para selecionar qual gráfico-->
          <div>
            <select id="idioma" onchange="atualiza_div(get_idioma());">
              <option value="1">Português</option>
	      <option value="2">Inglês</option>
	    </select>
	  </div>
        </div>
      </br></br>
	  <div id="corpo1" style="display: flex;justify-content: space-between;">
	    <div id="corpo1-1">
	    </div>  
	    <div id="corpo1-2">
	    </div>
	  </div>
  </div>


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script>window.jQuery || document.write('<script src="../../assets/js/vendor/jquery-slim.min.js"><\/script>')</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
<!--Inicio do JavaScript no Código-->
  <script>
        function atualiza_div(idioma)
	{
             area = 1;
	     d3.select("svg").remove();
	     d3.select("svg").remove();
             
             if(idioma == 2)
             {

                  dataset = {
		    "series": ["Agrarian Sciences","Applied and Social Sciences", "Biological Sciences","Engineering", "Exact and Earth Sciences","Health Sciences","Humanities","Linguistics Letters and Arts"],                         
                    "colors": ["#F65582", "#F88B16", "#4D5048", "#3BBE90", "#3FC0FF", "#DD87FB", "#74BF00", "#D1B7A9"]
		  }
		  imprimeGrafico(2, "../files/at"+idioma+".csv", 'corpo1-1', dataset);
             }
             else if(idioma == 1)
             {
                 dataset = {
		   "series": ["Ciências Agrárias","Ciências Biológicas","Ciências da Saúde","Ciências Exatas e da Terra","Ciências Humanas","Ciências Sociais e Aplicadas","Engenharias","Linguitíca Letras e Artes"],                         
                   "colors": ["#F65582", "#4D5048", "#DD87FB", "#3FC0FF", "#74BF00",  "#F88B16", "#3BBE90", "#D1B7A9"]
		 }
		 imprimeGrafico(1, "../files/at"+idioma+".csv", 'corpo1-1', dataset);
            }

	}

	function imprimeGrafico(idioma, arquivo, divsvg, dataset)
        {

             var margin = {top: 30, right: 30, bottom: 30, left: 50},
			  width = document.getElementById(divsvg).offsetWidth - (margin.left) - (margin.right),
			  height = document.getElementById(divsvg).offsetHeight - (margin.top) - (margin.bottom);

             var parseDate = d3.time.format("%Y").parse;

	     var x = d3.time.scale().range([0, width]);
             var y = d3.scale.linear().range([height, 0]);

             var xAxis = d3.svg.axis().scale(x).tickSize(5).tickPadding(6).orient("bottom").ticks(5);
             var yAxis = d3.svg.axis().scale(y).orient("left").ticks(5).tickFormat(d3.format(".0%"));

             var line = d3.svg.line()  
		  .interpolate("linear")
		  .x(function(d) { return x(d.ano); })
		  .y(function(d) { return y(d.qtde); });


//cria o svg que receberá o Grafico
	     var svg = d3.select("div#"+divsvg).append("svg")
		  .attr("width", width + (margin.left + margin.right))
		  .attr("height", height + margin.top + margin.bottom)
		.append("g")
		  .attr("transform", "translate(" + margin.left + "," + margin.top + ")"); 

// gridlines in x axis function
function make_x_gridlines() {		
    return d3.svg.axis().scale(x).tickSize(5).tickPadding(6).orient("bottom").ticks(5);
}

// gridlines in y axis function
function make_y_gridlines() {		
    return d3.svg.axis().scale(y).orient("left").ticks(5);
}
                             
             d3.csv(arquivo, function(error, data) {
		    data.forEach(function(d) {
				d.ano = parseDate(d.ano);
				d.qtde = +d.qtde;
		    });
               
               x.domain(d3.extent(data, function(d) { return d.ano; }));
               y.domain([0, 1]);

  // add the X gridlines
  svg.append("g")			
      .attr("class", "grid")
      .attr("transform", "translate(0," + height + ")")
      .call(make_x_gridlines()
          .tickSize(-height)
          .tickFormat("")
      )

  // add the Y gridlines
  svg.append("g")			
      .attr("class", "grid")
      .call(make_y_gridlines()
          .tickSize(-width)
          .tickFormat("")
      )

		// Nest the entries by symbol
		    var dataNest = d3.nest()
			.key(function(d) {return d.great_area;})
			.entries(data);
		    var color = d3.scale.category10();
		 // set the colour scale
		    // Loop through each symbol / key
		    dataNest.forEach(function(d) {
			svg.append("path")
			    .attr("class", "line")
			    .style("stroke", function() { // Add dynamically
				return d["values"][0].color; })
			    .attr("d", line(d.values));
		    });

//definido o dominio x do gráfico
                  svg.append("g")
                    .attr("class", "x axis")
                    .attr("transform", "translate(0," + height + ")")
                    .call(xAxis)		     
		    .style("font-size", "16px") ;


//definido o dominio y do gráfico
	          svg.append("g")
		    .attr("class", "y axis")
		    .call(yAxis)
		    .append("text")
		    .attr("transform", "rotate(-90)")
		    .attr("y", 6)
		    .attr("dy", ".71em")
		    .style("text-anchor", "end") 
		    .style("font-size", "16px") 
		    .text(function(){if(idioma == 1){return "Percentual de Publicações Interdisciplinares";}else{return "Average of Interdisciplinary Publications"}});


//Título do Gráfico *tittle* é adicionado aqui no svg
		  svg.append("text")
		    .attr("x", (width / 2))             
		    .attr("y", 0 - (margin.top / 2)+10)
		    .attr("text-anchor", "middle")  
		    .style("font-size", "30px") 
		    .text("");

		    var legend = svg.append("g")
		      .attr("class", "legend")

                    legend.selectAll('text')
		      .data(dataset["colors"])
		      .enter()
		      .append("rect")
		      .attr("x", function(d, i){return margin.right+60})
		      .attr("y", function(d, i){return (i *  15)+20;})
		      .attr("width", 200)
		      .attr("height", 20)
		      .style("fill", "#FFFAFA")

                    legend.selectAll('text')
		      .data(dataset["colors"])
		      .enter()
		      .append("rect")
		      .attr("x", function(d, i){return margin.right+70})
		      .attr("y", function(d, i){return (i *  15)+25;})
		      .attr("width", 10)
		      .attr("height", 10)
		      .style("fill", function(d) {
			return d;
		      })

		    legend.selectAll('text')
		      .data(dataset["series"])
		      .enter()
		    .append("text")
		    .attr("x", function(d, i){return margin.right+95})
		    .attr("y", function(d, i){return (i *  15+9)+25;})
		    .text(function(d){return d});
                                      
	     });
	}
        
        function get_idioma()
        {
          var idiomas = document.getElementById('idioma')
          return idiomas.options[idioma.selectedIndex].value
        }

        function get_area()
        {
          var areas = document.getElementById('area')
          return areas.options[area.selectedIndex].value
        }

  </script>
<!--Final do JavaScript no Código-->
  <script> atualiza_div(1);</script>
</body>
</html>
